{"version":3,"sources":["../../src/server/index.js"],"names":["require","Koa","Router","bodyParser","passport","path","serve","view","app","router","config","connect","process","env","DB_URI","use","join","__dirname","initialize","localSignupStrategy","localLoginStrategy","authCheckMiddleware","auth","api","routes","all","ctx","render","allowedMethods","listen","PORT"],"mappings":";;;;AAAAA,QAAQ,gBAAR;;AAEA,IAAMC,MAAMD,QAAQ,KAAR,CAAZ;AACA,IAAME,SAASF,QAAQ,YAAR,CAAf;AACA,IAAMG,aAAaH,QAAQ,gBAAR,CAAnB;AACA,IAAMI,WAAWJ,QAAQ,cAAR,CAAjB;AACA,IAAMK,OAAOL,QAAQ,MAAR,CAAb;AACA,IAAMM,QAAQN,QAAQ,YAAR,CAAd;AACA,IAAMO,OAAOP,QAAQ,UAAR,CAAb;;AAEA,IAAMQ,MAAM,IAAIP,GAAJ,EAAZ;AACA,IAAMQ,SAAS,IAAIP,MAAJ,EAAf;;AAEAF,QAAQ,QAAR,EAAkBU,MAAlB;AACAV,QAAQ,UAAR,EAAoBW,OAApB,CAA4BC,QAAQC,GAAR,CAAYC,MAAxC;;AAEAN,IAAIO,GAAJ,CAAQT,MAAMD,KAAKW,IAAL,CAAUC,SAAV,EAAqB,oBAArB,CAAN,CAAR;AACAT,IAAIO,GAAJ,CAAQR,KAAKF,KAAKW,IAAL,CAAUC,SAAV,EAAqB,cAArB,CAAL,CAAR;AACAT,IAAIO,GAAJ,CAAQZ,YAAR;AACAK,IAAIO,GAAJ,CAAQX,SAASc,UAAT,EAAR;;AAEA,IAAMC,sBAAsBnB,QAAQ,yBAAR,CAA5B;AACA,IAAMoB,qBAAqBpB,QAAQ,wBAAR,CAA3B;;AAEAI,SAASW,GAAT,CAAa,cAAb,EAA6BI,mBAA7B;AACAf,SAASW,GAAT,CAAa,aAAb,EAA4BK,kBAA5B;;AAEA,IAAMC,sBAAsBrB,QAAQ,yBAAR,CAA5B;;AAEAS,OAAOM,GAAP,CAAW,MAAX,EAAmBM,mBAAnB;;AAEA,IAAMC,OAAOtB,QAAQ,eAAR,CAAb;AACA,IAAMuB,MAAMvB,QAAQ,cAAR,CAAZ;;AAEAS,OAAOM,GAAP,CAAW,OAAX,EAAoBO,KAAKE,MAAL,EAApB;AACAf,OAAOM,GAAP,CAAW,MAAX,EAAmBQ,IAAIC,MAAJ,EAAnB;;AAEAf,OAAOgB,GAAP,CAAW,GAAX;AAAA,uDAAgB,iBAAMC,GAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACRA,IAAIC,MAAJ,CAAW,OAAX,CADQ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAhB;;AAAA;AAAA;AAAA;AAAA;;AAIAnB,IAAIO,GAAJ,CAAQN,OAAOe,MAAP,EAAR,EAAyBT,GAAzB,CAA6BN,OAAOmB,cAAP,EAA7B;;AAEApB,IAAIqB,MAAJ,CAAWjB,QAAQC,GAAR,CAAYiB,IAAZ,IAAoB,IAA/B","file":"index.js","sourcesContent":["require('babel-polyfill');\n\nconst Koa = require('koa');\nconst Router = require('koa-router');\nconst bodyParser = require('koa-bodyparser');\nconst passport = require('koa-passport');\nconst path = require('path');\nconst serve = require('koa-static');\nconst view = require('koa-view');\n\nconst app = new Koa();\nconst router = new Router();\n\nrequire('dotenv').config();\nrequire('./models').connect(process.env.DB_URI);\n\napp.use(serve(path.join(__dirname, '../../dist/client/')));\napp.use(view(path.join(__dirname, '../../static')));\napp.use(bodyParser());\napp.use(passport.initialize());\n\nconst localSignupStrategy = require('./passport/local-signup');\nconst localLoginStrategy = require('./passport/local-login');\n\npassport.use('local-signup', localSignupStrategy);\npassport.use('local-login', localLoginStrategy);\n\nconst authCheckMiddleware = require('./middleware/auth-check');\n\nrouter.use('/api', authCheckMiddleware);\n\nconst auth = require('./routes/auth');\nconst api = require('./routes/api');\n\nrouter.use('/auth', auth.routes());\nrouter.use('/api', api.routes());\n\nrouter.all('*', async ctx => {\n  await ctx.render('index');\n});\n\napp.use(router.routes()).use(router.allowedMethods());\n\napp.listen(process.env.PORT || 3000);\n"]}